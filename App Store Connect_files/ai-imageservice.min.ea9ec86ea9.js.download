!function(e,t){"object"==typeof angular&&angular.module?angular.module("ai-imageservice",[]).factory("ai",t):"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():e.ai=t()}(this,function(){var e=e||{};e.imageservice=e.imageservice||{},e.imageservice.FormatType={GIF:"gif",JPEG:"jpg",PNG:"png",TIFF:"tif",LSR:"lsr"},Object.freeze(e.imageservice.FormatType);var e=e||{};e.imageservice=e.imageservice||{},e.imageservice.ImageURLGenerator=function(t){"use strict";if(!t)throw Error("Must pass base url");this.rangedURL=new e.util.RangedURL({pattern:t}),this.getRangedURL=function(){return this.rangedURL},this.generateUrlForToken=function(e){var t="image/thumb/";t+=this.getToken(e),t+=this.getSize(e),t+=this.getResizeStyle(e),t+=this.getQuality(e),t+=this.getFormatType(e);var i=this.rangedURL.createResolvableUri(t);return i},this.getToken=function(e){var t="";if(!("token"in e))throw Error("Must include a token in request");return t+=e.token,t+="/"},this.getResizeStyle=function(t){var i="";return i+="resizeStyle"in t?t.resizeStyle:"0x0"===this.getSize(t)?e.imageservice.ResizeStyle.SOURCE_SIZE:this.getDefaultResizeStyle()},this.getSize=function(e){var t="";return"width"in e&&"height"in e?(t+=e.width.toString(),t+="x",t+=e.height.toString()):t+="0x0",t},this.getQuality=function(e){var t="";if("quality"in e){if(isNaN(e.quality))throw"quality is not a number";t+="-",t+=e.quality.toString()}return t},this.getFormatType=function(e){var t=".";return t+="formatType"in e?e.formatType:this.getDefaultImageFormat()},this.getDefaultResizeStyle=function(){return e.imageservice.ResizeStyle.BOUNDED_BOX},this.getDefaultImageFormat=function(){return e.imageservice.FormatType.JPEG}};var e=e||{};e.imageservice=e.imageservice||{},e.imageservice.ResizeStyle={BOUNDED_BOX:"bb",CONSTRAINED_HEIGHT:"h",CONSTRAINED_WIDTH:"w",SQUARE_CENTER_CROP:"cc",SPECIFIC_RECTANGLE:"sr",SOURCE_SIZE:"ss",CUSTOM:"cu"},Object.freeze(e.imageservice.ResizeStyle);var e=e||{};return e.util=e.util||{},e.util.RangedURL=function(e){"use strict";function t(e){this.message=e,this.name="RangedUrlException"}if("prefix"in e&&"suffix"in e&&"rangeStart"in e&&"rangeCount"in e)this.prefix=e.prefix,this.suffix=e.suffix,this.rangeStart=e.rangeStart,this.rangeCount=e.rangeCount;else{if(!("pattern"in e))throw new t("missing config properties");var i=e.pattern,r="",n=0,s=0;"/"!==i.charAt(i.length-1)&&(i+="/");var a=i.indexOf("["),u=a>=0?i.indexOf("-",a+1):-1,o=u>=0?i.indexOf("]",u+1):-1;if(a>=0&&u>=0&&o>=0){var g=parseInt(i.substring(a+1,u)),h=parseInt(i.substring(u+1,o));g>=0&&h>g&&(n=g,s=h-g+1,r=i.substring(o+1),i=i.substring(0,a))}this.pattern=e.pattern,this.prefix=i,this.suffix=r,this.rangeStart=n,this.rangeCount=s}this.toString=function(){return this.getPattern()},this.getPattern=function(){return this.pattern},this.getPrefix=function(){return this.prefix},this.getSuffix=function(){return this.suffix},this.getRangeStart=function(){return this.rangeStart},this.getRangeCount=function(){return this.rangeCount},this.uriForHostNumber=function(e){if(null===e)throw Error("uriForHostNumber requires a valid integer. Got "+e);return encodeURI(this.getPrefix()+e+this.getSuffix())},this.createResolvableUri=function(e){var t,i=this.rangeStart;this.getRangeCount()<=0?t=this.getPrefix():(null!==e&&(i+=(f(e)&Number.MAX_VALUE)%this.rangeCount),t=this.uriForHostNumber(i)),"/"!==t.charAt(t.length-1)&&(t+="/");var r;return r=null===e?t:t+e},this.getAllPossibleBases=function(){if(void 0===this.allPossibleBases){var e=[];if(this.getRangeCount()<=0)e.push(this.prefix);else for(var t=this.rangeStart,i=t+this.rangeCount,r=t;i>r;r++){var n=this.uriForHostNumber(r);e.push(n)}this.allPossibleBases=e}return this.allPossibleBases};var f=function(e){var t,i,r=0,n=e.length;if(0===n)return r;for(t=0;n>t;t++)i=e.charCodeAt(t),r=(r<<5)-r+i,r&=r;return Math.abs(r)}},e});