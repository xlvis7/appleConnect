/** itc-rankgrouper#0.0.11 **/
!function(t){function e(n){if(i[n])return i[n].exports;var a=i[n]={exports:{},id:n,loaded:!1};return t[n].call(a.exports,a,a.exports,e),a.loaded=!0,a.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){"use strict";function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=i(1),h=i(2),u=function(){function t(e,i){r(this,t),this.index=e,this.root=i,this.render()}return s(t,[{key:"render",value:function(){this.el=document.createElement("div"),this.root.el.appendChild(this.el),(0,o.$$)(this.el).addClass("divider"),this.createVisualDivider(),this.el.addEventListener("dragover",this.onDragOver.bind(this)),this.el.addEventListener("dragenter",this.onDragEnter.bind(this)),this.el.addEventListener("dragleave",this.onDragLeave.bind(this)),this.el.addEventListener("drop",this.onDragDrop.bind(this))}},{key:"onDragOver",value:function(t){t.preventDefault()}},{key:"onDragEnter",value:function(t){return!!this.checkDrag()&&((0,o.$$)(this.el).addClass("highlighted"),t)}},{key:"onDragLeave",value:function(t){return(0,o.$$)(this.el).removeClass("highlighted"),t}},{key:"onDragDrop",value:function(t){return!!this.checkDrag()&&(this.root.flatReindex(this,this.root.draggedItem),this.onDragLeave(t),t)}},{key:"checkDrag",value:function(){return this.root.draggedItem.parent.items.length>1||!~[this.root.draggedItem.parent.index,this.root.draggedItem.parent.index+1].indexOf(this.index)}},{key:"createVisualDivider",value:function(){this.visualDivider=document.createElement("div"),this.el.appendChild(this.visualDivider),(0,o.$$)(this.visualDivider).addClass("visual-divider")}}]),t}(),l=function(){function t(e){r(this,t),this.parent=e,this.root=this.parent.parent.root,this.data=this.parent.data,this.render(),this.target=null}return s(t,[{key:"render",value:function(){this.createContainer(),this.createTitle(),this.createDuration(),this.createStatus(),this.createHamburger(),this.el.setAttribute("draggable",!0),this.el.addEventListener("mousedown",this.onMouseDown.bind(this)),this.el.addEventListener("mouseup",this.onMouseUp.bind(this)),this.el.addEventListener("dragstart",this.onDragStart.bind(this)),this.el.addEventListener("dragend",this.onDragEnd.bind(this))}},{key:"createContainer",value:function(){this.el=document.createElement("div"),this.parent.el.appendChild(this.el),(0,o.$$)(this.el).addClass("rank-wrapper")}},{key:"createTitle",value:function(){this.titleVal=document.createElement("div"),this.el.appendChild(this.titleVal),(0,o.$$)(this.titleVal).addClass("rank-title"),this.titleVal.innerHTML=this.data.title,this.titleVal.addEventListener("click",this.onTitleClick.bind(this)),this.root.titleWidths.push(this.titleVal.getBoundingClientRect().width)}},{key:"createDuration",value:function(){this.durationVal=document.createElement("div"),this.el.appendChild(this.durationVal),(0,o.$$)(this.durationVal).addClass("rank-duration"),this.durationVal.innerHTML=this.data.duration,this.root.durationWidths.push(this.durationVal.getBoundingClientRect().width)}},{key:"createStatus",value:function(){this.statusVal=document.createElement("div"),this.el.appendChild(this.statusVal),(0,o.$$)(this.statusVal).addClass("rank-duration"),this.statusVal.innerHTML=this.data.status,this.root.statusWidths.push(this.statusVal.getBoundingClientRect().width)}},{key:"createHamburger",value:function(){this.grabber=document.createElement("div"),this.el.appendChild(this.grabber),(0,o.$$)(this.grabber).addClass("rank-grabber"),this.hamburger=document.createElement("div"),this.grabber.appendChild(this.hamburger),(0,o.$$)(this.hamburger).addClass("rank-hamburger"),this.root.itemCount<=1&&(0,o.$$)(this.grabber).addClass("disabled")}},{key:"onTitleClick",value:function(t){return this.root.scope.onTitleClick(this.parent.data),t}},{key:"onMouseDown",value:function(t){return this.target=this.root.getTarget(t),this.grabber.contains(this.target)&&this.root.itemCount>1&&(0,o.$$)(this.parent.el).addClass("grabbed"),t}},{key:"onMouseUp",value:function(t){return(0,o.$$)(this.parent.el).removeClass("grabbed"),t}},{key:"onDragStart",value:function(t){var e=this;this.grabber.contains(this.target)&&this.root.itemCount>1?(o.utils.exists(t.dataTransfer)&&t.dataTransfer.setData("text",t.target.id),this.root.draggedItem=this.parent,this.parent.parent.isDragging=!0,setTimeout(function(){e.el.style.visibility="hidden",1===e.parent.parent.data.length&&(0,o.$$)(e.parent.parent.el).addClass("hideborder")},0)):t.preventDefault()}},{key:"onDragEnd",value:function(t){this.root.draggedItem=null,this.parent.parent.isDragging=!1,this.el.style.visibility="visible",(0,o.$$)(this.parent.parent.el).removeClass("hideborder"),this.onMouseUp(t)}},{key:"makeReadOnly",value:function(){this.grabber.classList.add("disabled")}}]),t}(),d=function(){function t(e,i,n){r(this,t),this.data=e,this.index=i,this.parent=n,this.render()}return s(t,[{key:"render",value:function(){this.createEl(),this.createNumber(),this.details=new l(this)}},{key:"createEl",value:function(){this.el=document.createElement("div"),this.parent.contentContainer.appendChild(this.el),(0,o.$$)(this.el).addClass("content-item rank-container")}},{key:"createNumber",value:function(){this.numberVal=document.createElement("div"),this.el.appendChild(this.numberVal),(0,o.$$)(this.numberVal).addClass("rank-number"),this.numberVal.innerHTML=this.parent.index+1}}]),t}(),c=function(){function t(e,i,n){r(this,t),this.data=e,this.index=i,this.root=n,this.items=[],this.isDragging=!1,this.makeShell(),this.createContentContainer(),this.createItems()}return s(t,[{key:"makeShell",value:function(){this.el=document.createElement("div"),this.root.el.appendChild(this.el),(0,o.$$)(this.el).addClass("grouping")}},{key:"createContentContainer",value:function(){this.contentContainer=document.createElement("div"),this.el.appendChild(this.contentContainer),(0,o.$$)(this.contentContainer).addClass("rank-content"),this.el.addEventListener("dragover",this.onDragOver.bind(this)),this.el.addEventListener("dragenter",this.onDragEnter.bind(this)),this.el.addEventListener("dragleave",this.onDragLeave.bind(this)),this.el.addEventListener("drop",this.onDragDrop.bind(this))}},{key:"onDragOver",value:function(t){t.preventDefault()}},{key:"onDragEnter",value:function(t){return!this.isDragging&&((0,o.$$)(this.el).addClass("highlighted"),t)}},{key:"onDragLeave",value:function(t){return(0,o.$$)(this.el).removeClass("highlighted"),t}},{key:"onDragDrop",value:function(t){return!this.isDragging&&(this.root.groupReindex(this,this.root.draggedItem),this.onDragLeave(t),t)}},{key:"createItems",value:function(){var t=this;this.items=this.data.map(function(e,i){return new d(e,i,t)})}}]),t}(),f=function(t){function e(){return r(this,e),n(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),s(e,[{key:"_setDefaults",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.alteredItem=null,this.draggedItem=null,this.scope=t.scope}},{key:"render",value:function(){if(this.data=this.scope.data,!this.checkDataStructure())throw new Error("itcRankGrouper: ids are required in the data structure");return this.el.innerHTML="",this.groups=[],this.dividers=[],this.titleWidths=[],this.durationWidths=[],this.statusWidths=[],this.itemCount>1&&this.dividers.push(new u(0,this)),this.data.forEach(this.createLine.bind(this)),this.divSizer(),setTimeout(this.divSizer.bind(this),0),this.highlightChange(),!0}},{key:"getTarget",value:function(t){return t.target}},{key:"checkDataStructure",value:function(){if(!o.utils.exists(this.data)||0===this.data.length)return!0;for(var t=0;t<this.data.length;t++)if(this.data[t].filter(function(t){return!o.utils.exists(t.id)}).length>0)return!1;return!0}},{key:"divSizer",value:function(){var t=this;this.groups.forEach(function(e){e.items.forEach(function(e){e.details.titleVal.style.width=Math.max.apply(t,t.titleWidths)+"px",e.details.durationVal.style.width=Math.max.apply(t,t.durationWidths)+"px",e.details.statusVal.style.width=Math.max.apply(t,t.statusWidths)+"px"})})}},{key:"highlightChange",value:function(){var t=this;o.utils.exists(this.alteredItem)&&this.groups.forEach(function(e){e.items.filter(function(e){return e.data.id===t.alteredItem.data.id}).length>0&&(0,o.$$)(e.el).addClass("notify")})}},{key:"reRender",value:function(){this.data=this.newData.map(function(t){return t.sort(function(t,e){return t.title.toLowerCase()>e.title.toLowerCase()})}),this.scope.data=this.data,this.scope.$$phase||this.scope.$root.$$phase||this.scope.$apply(),this.scope.onUpdate(this.data)}},{key:"createLine",value:function(t,e){this.groups.push(new c(t,e,this)),this.itemCount>1&&this.dividers.push(new u(e+1,this))}},{key:"flatReindex",value:function(t,e){var i=this;this.alteredItem=e,this.newData=[],this.data.forEach(function(n,a){t.index===a&&i.newData.push([e.data]);var r=n.filter(function(t){return t.id!==e.data.id});r.length>0&&i.newData.push(r)}),this.data.length===t.index&&this.newData.push([e.data]),this.reRender()}},{key:"groupReindex",value:function(t,e){this.alteredItem=e,this.newData=this.data.map(function(i,n){return t.index===n?i.push(e.data):i=i.filter(function(t){return t.id!==e.data.id}),i}).filter(function(t){return t.length>0}),this.reRender()}},{key:"readOnly",value:function(){this.groups.forEach(function(t){t.items.forEach(function(t){t.details.makeReadOnly()})})}},{key:"mainClass",get:function(){return"itc-rank-grouper"}},{key:"itemCount",get:function(){return this.data.reduce(function(t,e){return e.length+t},0)}}]),e}(h.BaseComponent);window.RankGrouper=f,window.angular.module("itc-rank-grouper",[]).directive("itcRankGrouper",function(){var t={link:function(t,e){(0,o.$$)(e[0]).addClass("itc-rank-grouper");var i=new f(e[0],{scope:t});t.self=i,t.$watch("data",function(t){o.utils.exists(t)&&i.render()}),t.$watch("readOnly",function(t){o.utils.exists(t)&&t&&i.readOnly()}),t.rankGrouper=i},restrict:"A",scope:{self:"=?itcRankGrouper",data:"=",onUpdate:"=",onTitleClick:"=",readOnly:"=?"}};return t})},function(t,e){"use strict";function i(t){return{getClasses:function(){return t.className.split(" ")},hasClass:function(t){return this.getClasses().indexOf(t)>-1},find:function(e){return t.getElementsByClassName(e)},addClass:function(e){return this.hasClass(e)||(t.className+=" "+e),this},removeClass:function(e){var i=this.getClasses(),n=i.indexOf(e);return n>-1&&(i.splice(n,1),t.className=i.join(" ")),this}}}Object.defineProperty(e,"__esModule",{value:!0}),e.$$=i;/*! @tidbits/tidbits-utils@1.3.0 */
e.utilsMsg="We Are using ES6 with Babel & Webpack Support",e.utils={exists:function(t){return"undefined"!=typeof t&&null!==t},getByClassName:function(t){return document.getElementsByClassName(t)}}},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.BaseComponent=void 0;var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=i(1);e.BaseComponent=function(){function t(e,i){if(n(this,t),!r.utils.exists(e))throw new Error(this.constructor.name+": element to attach to is required");this.el=e,this._setDefaults(i)}return a(t,[{key:"_setDefaults",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t}},{key:"mainClass",get:function(){return"classPlaceHolder"}},{key:"el",get:function(){return this._el},set:function(t){var e=this,i=function(){throw new Error(e.constructor.name+": root dom element is required")};if("string"==typeof t?(t=document.querySelector(t),r.utils.exists(t)?this._el=t:i()):t instanceof HTMLElement?this._el=t:i(),this.checkClass&&!(0,r.$$)(this._el).hasClass(this.mainClass))throw new Error(this.constructor.name+": "+this.mainClass+" class on this element is required")}},{key:"checkClass",get:function(){return!0}}]),t}()}]);